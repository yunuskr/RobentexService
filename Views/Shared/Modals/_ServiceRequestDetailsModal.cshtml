@* SADECE <template> üretir *@
<template id="details-modal-tpl">
  <div class="rtx-modal-backdrop" data-modal>
    <div class="rtx-modal">
      <div class="rtx-modal-head">
        <h3>Talep Detayı</h3>
        <button type="button" class="x" data-close aria-label="Kapat">&times;</button>
      </div>

      <!-- İKİ SÜTUNLU IZGARA -->
      <div class="rtx-modal-body details-grid">
        <!-- Sıra 1 -->
        <div class="grp">
          <label>Firma</label>
          <input class="inp ro" data-dsp="CompanyName" readonly />
        </div>
        <div class="grp">
          <label>Başlık</label>
          <input class="inp ro" data-dsp="Title" readonly />
        </div>

        <!-- Sıra 2 -->
        <div class="grp">
          <label>Durum</label>
          <input class="inp ro" data-dsp="StatusText" readonly />
        </div>
        <div class="grp">
          <label>Robentex Sipariş No</label>
          <input class="inp ro" data-dsp="RobentexOrderNo" readonly />
        </div>

        <!-- Sıra 3 -->
        <div class="grp">
          <label>Talep Eden</label>
          <input class="inp ro" data-dsp="Requester" readonly />
        </div>
        <div class="grp">
          <label>Talep Eden Tel</label>
          <input class="inp ro" data-dsp="Phone" readonly />
        </div>

        <!-- Sıra 4 -->
        <div class="grp">
          <label>Talep Eden Mail</label>
          <input class="inp ro" data-dsp="Email" readonly />
        </div>
        <div class="grp">
          <label>Robot Model</label>
          <input class="inp ro" data-dsp="RobotModel" readonly />
        </div>

        <!-- Sıra 5 -->
        <div class="grp">
          <label>Robot Seri No</label>
          <input class="inp ro" data-dsp="RobotSerial" readonly />
        </div>
        <div class="grp">
          <label>Son Düzenlenme</label>
          <input class="inp ro" data-dsp="LastModified" readonly />
        </div>

        <!-- Arıza Tanımı: TAM GENİŞLİK (daha kompakt) -->
        <div class="grp" style="grid-column:1 / -1;">
          <label>Arıza Tanımı</label>
          <textarea class="inp ro compact" rows="3" data-dsp="FaultDescription" readonly></textarea>
        </div>

        <!-- NOTLAR: TAM GENİŞLİK -->
        <div class="grp row-notes">
          <label>Notlar</label>
          <div class="notes" data-notes></div>
        </div>
      </div>

      <div class="rtx-modal-foot">
        <button type="button" class="btn" data-close>Kapat</button>
      </div>

      @* Silme isteklerinde kullanılacak gizli antiforgery token *@
      <form id="details-af-token" style="display:none;">
        @Html.AntiForgeryToken()
      </form>
    </div>
  </div>
</template>

<style>
/* Detay grid: masaüstünde dış scroll kapalı, mobilde açık */
.rtx-modal-body.details-grid{ overflow:auto; min-height:0; }
.details-grid .row-notes{ grid-column:1 / -1; min-height:0; }
.details-grid .notes{ max-height:220px; overflow:auto; display:flex; flex-direction:column; gap:8px; }

/* Not görünümü + sağda Sil butonu */
.details-grid .notes .note{
  display:flex; align-items:flex-start; gap:10px;
  background:#2a2a2a; border:1px solid #3a3a3a; border-radius:12px;
  padding:8px 10px;
}
.details-grid .notes .note .when{ color:#9aa0a6; font-size:.86rem; margin-bottom:4px; }
.details-grid .notes .note .txt{ white-space:pre-wrap; }
.note .note-del{
  margin-left:auto;
  background:#3a2222; border:1px solid #5a2a2a; color:#ffdede;
  padding:.35rem .6rem; border-radius:10px; cursor:pointer; font-weight:700;
}
.note .note-del:hover{ filter:brightness(1.05); }
.note .note-del:active{ transform:translateY(1px); }

/* Daha yüksek ekranlarda not listesini büyüt */
@@media (min-height:820px){
  .rtx-modal-body.details-grid{ overflow:hidden; }
  .details-grid .notes{ max-height:320px; }
}
/* Çok kısa ekranlar */
@@media (max-height:640px){ .details-grid .notes{ max-height:180px; } }

/* SADECE MOBİL (≤820px) */
@@media (max-width:820px){
  .rtx-modal{ width:96vw; max-height:96vh; }
  .rtx-modal-body.details-grid{
    display:grid; grid-template-columns:1fr !important; gap:10px;
    flex:1 1 auto; min-height:0; overflow:auto; padding:12px 14px;
  }
  .details-grid .row-notes .notes{ max-height:45vh; overflow:auto; }
  .rtx-modal-body.details-grid .inp{ font-size:16px; }
  .rtx-modal-body.details-grid::-webkit-scrollbar{ width:10px; }
  .rtx-modal-body.details-grid::-webkit-scrollbar-thumb{
    background:#555; border-radius:10px; border:2px solid #2f2f2f;
  }
  .details-grid textarea[data-dsp="FaultDescription"]{
  min-height: 64px;
  max-height: 110px;     /* önceki halinden daha küçük */
  overflow: auto;        /* içerik uzun olursa textarea içinde scroll */
  resize: vertical;      /* istersen kullanıcı dikeyde büyütebilsin */
}
}
</style>
